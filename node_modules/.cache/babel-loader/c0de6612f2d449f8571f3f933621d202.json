{"ast":null,"code":"'use strict';\n\nconst util = require('./util');\n\nconst buildOptions = require('./util').buildOptions;\n\nconst x2j = require('./xmlstr2xmlnode'); //TODO: do it later\n\n\nconst convertToJsonString = function (node, options) {\n  options = buildOptions(options, x2j.defaultOptions, x2j.props);\n  options.indentBy = options.indentBy || '';\n  return _cToJsonStr(node, options, 0);\n};\n\nconst _cToJsonStr = function (node, options, level) {\n  let jObj = '{'; //traver through all the children\n\n  const keys = Object.keys(node.child);\n\n  for (let index = 0; index < keys.length; index++) {\n    var tagname = keys[index];\n\n    if (node.child[tagname] && node.child[tagname].length > 1) {\n      jObj += '\"' + tagname + '\" : [ ';\n\n      for (var tag in node.child[tagname]) {\n        jObj += _cToJsonStr(node.child[tagname][tag], options) + ' , ';\n      }\n\n      jObj = jObj.substr(0, jObj.length - 1) + ' ] '; //remove extra comma in last\n    } else {\n      jObj += '\"' + tagname + '\" : ' + _cToJsonStr(node.child[tagname][0], options) + ' ,';\n    }\n  }\n\n  util.merge(jObj, node.attrsMap); //add attrsMap as new children\n\n  if (util.isEmptyObject(jObj)) {\n    return util.isExist(node.val) ? node.val : '';\n  } else {\n    if (util.isExist(node.val)) {\n      if (!(typeof node.val === 'string' && (node.val === '' || node.val === options.cdataPositionChar))) {\n        jObj += '\"' + options.textNodeName + '\" : ' + stringval(node.val);\n      }\n    }\n  } //add value\n\n\n  if (jObj[jObj.length - 1] === ',') {\n    jObj = jObj.substr(0, jObj.length - 2);\n  }\n\n  return jObj + '}';\n};\n\nfunction stringval(v) {\n  if (v === true || v === false || !isNaN(v)) {\n    return v;\n  } else {\n    return '\"' + v + '\"';\n  }\n}\n\nfunction indentate(options, level) {\n  return options.indentBy.repeat(level);\n}\n\nexports.convertToJsonString = convertToJsonString;","map":{"version":3,"names":["util","require","buildOptions","x2j","convertToJsonString","node","options","defaultOptions","props","indentBy","_cToJsonStr","level","jObj","keys","Object","child","index","length","tagname","tag","substr","merge","attrsMap","isEmptyObject","isExist","val","cdataPositionChar","textNodeName","stringval","v","isNaN","indentate","repeat","exports"],"sources":["/Users/yzbaoo/Desktop/huohua/ilc-web-packages/node_modules/fast-xml-parser/src/node2json_str.js"],"sourcesContent":["'use strict';\n\nconst util = require('./util');\nconst buildOptions = require('./util').buildOptions;\nconst x2j = require('./xmlstr2xmlnode');\n\n//TODO: do it later\nconst convertToJsonString = function(node, options) {\n  options = buildOptions(options, x2j.defaultOptions, x2j.props);\n\n  options.indentBy = options.indentBy || '';\n  return _cToJsonStr(node, options, 0);\n};\n\nconst _cToJsonStr = function(node, options, level) {\n  let jObj = '{';\n\n  //traver through all the children\n  const keys = Object.keys(node.child);\n\n  for (let index = 0; index < keys.length; index++) {\n    var tagname = keys[index];\n    if (node.child[tagname] && node.child[tagname].length > 1) {\n      jObj += '\"' + tagname + '\" : [ ';\n      for (var tag in node.child[tagname]) {\n        jObj += _cToJsonStr(node.child[tagname][tag], options) + ' , ';\n      }\n      jObj = jObj.substr(0, jObj.length - 1) + ' ] '; //remove extra comma in last\n    } else {\n      jObj += '\"' + tagname + '\" : ' + _cToJsonStr(node.child[tagname][0], options) + ' ,';\n    }\n  }\n  util.merge(jObj, node.attrsMap);\n  //add attrsMap as new children\n  if (util.isEmptyObject(jObj)) {\n    return util.isExist(node.val) ? node.val : '';\n  } else {\n    if (util.isExist(node.val)) {\n      if (!(typeof node.val === 'string' && (node.val === '' || node.val === options.cdataPositionChar))) {\n        jObj += '\"' + options.textNodeName + '\" : ' + stringval(node.val);\n      }\n    }\n  }\n  //add value\n  if (jObj[jObj.length - 1] === ',') {\n    jObj = jObj.substr(0, jObj.length - 2);\n  }\n  return jObj + '}';\n};\n\nfunction stringval(v) {\n  if (v === true || v === false || !isNaN(v)) {\n    return v;\n  } else {\n    return '\"' + v + '\"';\n  }\n}\n\nfunction indentate(options, level) {\n  return options.indentBy.repeat(level);\n}\n\nexports.convertToJsonString = convertToJsonString;\n"],"mappings":"AAAA;;AAEA,MAAMA,IAAI,GAAGC,OAAO,CAAC,QAAD,CAApB;;AACA,MAAMC,YAAY,GAAGD,OAAO,CAAC,QAAD,CAAP,CAAkBC,YAAvC;;AACA,MAAMC,GAAG,GAAGF,OAAO,CAAC,kBAAD,CAAnB,C,CAEA;;;AACA,MAAMG,mBAAmB,GAAG,UAASC,IAAT,EAAeC,OAAf,EAAwB;EAClDA,OAAO,GAAGJ,YAAY,CAACI,OAAD,EAAUH,GAAG,CAACI,cAAd,EAA8BJ,GAAG,CAACK,KAAlC,CAAtB;EAEAF,OAAO,CAACG,QAAR,GAAmBH,OAAO,CAACG,QAAR,IAAoB,EAAvC;EACA,OAAOC,WAAW,CAACL,IAAD,EAAOC,OAAP,EAAgB,CAAhB,CAAlB;AACD,CALD;;AAOA,MAAMI,WAAW,GAAG,UAASL,IAAT,EAAeC,OAAf,EAAwBK,KAAxB,EAA+B;EACjD,IAAIC,IAAI,GAAG,GAAX,CADiD,CAGjD;;EACA,MAAMC,IAAI,GAAGC,MAAM,CAACD,IAAP,CAAYR,IAAI,CAACU,KAAjB,CAAb;;EAEA,KAAK,IAAIC,KAAK,GAAG,CAAjB,EAAoBA,KAAK,GAAGH,IAAI,CAACI,MAAjC,EAAyCD,KAAK,EAA9C,EAAkD;IAChD,IAAIE,OAAO,GAAGL,IAAI,CAACG,KAAD,CAAlB;;IACA,IAAIX,IAAI,CAACU,KAAL,CAAWG,OAAX,KAAuBb,IAAI,CAACU,KAAL,CAAWG,OAAX,EAAoBD,MAApB,GAA6B,CAAxD,EAA2D;MACzDL,IAAI,IAAI,MAAMM,OAAN,GAAgB,QAAxB;;MACA,KAAK,IAAIC,GAAT,IAAgBd,IAAI,CAACU,KAAL,CAAWG,OAAX,CAAhB,EAAqC;QACnCN,IAAI,IAAIF,WAAW,CAACL,IAAI,CAACU,KAAL,CAAWG,OAAX,EAAoBC,GAApB,CAAD,EAA2Bb,OAA3B,CAAX,GAAiD,KAAzD;MACD;;MACDM,IAAI,GAAGA,IAAI,CAACQ,MAAL,CAAY,CAAZ,EAAeR,IAAI,CAACK,MAAL,GAAc,CAA7B,IAAkC,KAAzC,CALyD,CAKT;IACjD,CAND,MAMO;MACLL,IAAI,IAAI,MAAMM,OAAN,GAAgB,MAAhB,GAAyBR,WAAW,CAACL,IAAI,CAACU,KAAL,CAAWG,OAAX,EAAoB,CAApB,CAAD,EAAyBZ,OAAzB,CAApC,GAAwE,IAAhF;IACD;EACF;;EACDN,IAAI,CAACqB,KAAL,CAAWT,IAAX,EAAiBP,IAAI,CAACiB,QAAtB,EAlBiD,CAmBjD;;EACA,IAAItB,IAAI,CAACuB,aAAL,CAAmBX,IAAnB,CAAJ,EAA8B;IAC5B,OAAOZ,IAAI,CAACwB,OAAL,CAAanB,IAAI,CAACoB,GAAlB,IAAyBpB,IAAI,CAACoB,GAA9B,GAAoC,EAA3C;EACD,CAFD,MAEO;IACL,IAAIzB,IAAI,CAACwB,OAAL,CAAanB,IAAI,CAACoB,GAAlB,CAAJ,EAA4B;MAC1B,IAAI,EAAE,OAAOpB,IAAI,CAACoB,GAAZ,KAAoB,QAApB,KAAiCpB,IAAI,CAACoB,GAAL,KAAa,EAAb,IAAmBpB,IAAI,CAACoB,GAAL,KAAanB,OAAO,CAACoB,iBAAzE,CAAF,CAAJ,EAAoG;QAClGd,IAAI,IAAI,MAAMN,OAAO,CAACqB,YAAd,GAA6B,MAA7B,GAAsCC,SAAS,CAACvB,IAAI,CAACoB,GAAN,CAAvD;MACD;IACF;EACF,CA5BgD,CA6BjD;;;EACA,IAAIb,IAAI,CAACA,IAAI,CAACK,MAAL,GAAc,CAAf,CAAJ,KAA0B,GAA9B,EAAmC;IACjCL,IAAI,GAAGA,IAAI,CAACQ,MAAL,CAAY,CAAZ,EAAeR,IAAI,CAACK,MAAL,GAAc,CAA7B,CAAP;EACD;;EACD,OAAOL,IAAI,GAAG,GAAd;AACD,CAlCD;;AAoCA,SAASgB,SAAT,CAAmBC,CAAnB,EAAsB;EACpB,IAAIA,CAAC,KAAK,IAAN,IAAcA,CAAC,KAAK,KAApB,IAA6B,CAACC,KAAK,CAACD,CAAD,CAAvC,EAA4C;IAC1C,OAAOA,CAAP;EACD,CAFD,MAEO;IACL,OAAO,MAAMA,CAAN,GAAU,GAAjB;EACD;AACF;;AAED,SAASE,SAAT,CAAmBzB,OAAnB,EAA4BK,KAA5B,EAAmC;EACjC,OAAOL,OAAO,CAACG,QAAR,CAAiBuB,MAAjB,CAAwBrB,KAAxB,CAAP;AACD;;AAEDsB,OAAO,CAAC7B,mBAAR,GAA8BA,mBAA9B"},"metadata":{},"sourceType":"script"}