{"ast":null,"code":"import { __assign, __awaiter, __generator } from \"tslib\";\nimport { SignatureV4 } from \"@aws-sdk/signature-v4\";\n\nvar S3SignatureV4 = function () {\n  function S3SignatureV4(options) {\n    this.sigv4Signer = new SignatureV4(options);\n    this.signerOptions = options;\n  }\n\n  S3SignatureV4.prototype.sign = function (requestToSign, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (options.signingRegion === \"*\") {\n          if (this.signerOptions.runtime !== \"node\") throw new Error(\"This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js\");\n          return [2, this.getSigv4aSigner().sign(requestToSign, options)];\n        }\n\n        return [2, this.sigv4Signer.sign(requestToSign, options)];\n      });\n    });\n  };\n\n  S3SignatureV4.prototype.presign = function (originalRequest, options) {\n    if (options === void 0) {\n      options = {};\n    }\n\n    return __awaiter(this, void 0, void 0, function () {\n      return __generator(this, function (_a) {\n        if (options.signingRegion === \"*\") {\n          if (this.signerOptions.runtime !== \"node\") throw new Error(\"This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js\");\n          return [2, this.getSigv4aSigner().presign(originalRequest, options)];\n        }\n\n        return [2, this.sigv4Signer.presign(originalRequest, options)];\n      });\n    });\n  };\n\n  S3SignatureV4.prototype.getSigv4aSigner = function () {\n    if (!this.sigv4aSigner) {\n      var CrtSignerV4_1;\n\n      try {\n        CrtSignerV4_1 = require(\"@aws-sdk/signature-v4-crt\").CrtSignerV4;\n        if (typeof CrtSignerV4_1 !== \"function\") throw new Error();\n      } catch (e) {\n        e.message = e.message + \"\\nPlease check if you have installed \\\"@aws-sdk/signature-v4-crt\\\" package explicitly. \\n\" + \"For more information please go to https://github.com/aws/aws-sdk-js-v3#known-issues\";\n        throw e;\n      }\n\n      this.sigv4aSigner = new CrtSignerV4_1(__assign(__assign({}, this.signerOptions), {\n        signingAlgorithm: 1\n      }));\n    }\n\n    return this.sigv4aSigner;\n  };\n\n  return S3SignatureV4;\n}();\n\nexport { S3SignatureV4 };","map":{"version":3,"names":["__assign","__awaiter","__generator","SignatureV4","S3SignatureV4","options","sigv4Signer","signerOptions","prototype","sign","requestToSign","_a","signingRegion","runtime","Error","getSigv4aSigner","presign","originalRequest","sigv4aSigner","CrtSignerV4_1","require","CrtSignerV4","e","message","signingAlgorithm"],"sources":["/Users/yzbaoo/Desktop/huohua/ilc-web-packages/node_modules/@aws-sdk/middleware-sdk-s3/dist-es/S3SignatureV4.js"],"sourcesContent":["import { __assign, __awaiter, __generator } from \"tslib\";\nimport { SignatureV4 } from \"@aws-sdk/signature-v4\";\nvar S3SignatureV4 = (function () {\n    function S3SignatureV4(options) {\n        this.sigv4Signer = new SignatureV4(options);\n        this.signerOptions = options;\n    }\n    S3SignatureV4.prototype.sign = function (requestToSign, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (options.signingRegion === \"*\") {\n                    if (this.signerOptions.runtime !== \"node\")\n                        throw new Error(\"This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js\");\n                    return [2, this.getSigv4aSigner().sign(requestToSign, options)];\n                }\n                return [2, this.sigv4Signer.sign(requestToSign, options)];\n            });\n        });\n    };\n    S3SignatureV4.prototype.presign = function (originalRequest, options) {\n        if (options === void 0) { options = {}; }\n        return __awaiter(this, void 0, void 0, function () {\n            return __generator(this, function (_a) {\n                if (options.signingRegion === \"*\") {\n                    if (this.signerOptions.runtime !== \"node\")\n                        throw new Error(\"This request requires signing with SigV4Asymmetric algorithm. It's only available in Node.js\");\n                    return [2, this.getSigv4aSigner().presign(originalRequest, options)];\n                }\n                return [2, this.sigv4Signer.presign(originalRequest, options)];\n            });\n        });\n    };\n    S3SignatureV4.prototype.getSigv4aSigner = function () {\n        if (!this.sigv4aSigner) {\n            var CrtSignerV4_1;\n            try {\n                CrtSignerV4_1 = require(\"@aws-sdk/signature-v4-crt\").CrtSignerV4;\n                if (typeof CrtSignerV4_1 !== \"function\")\n                    throw new Error();\n            }\n            catch (e) {\n                e.message =\n                    e.message + \"\\nPlease check if you have installed \\\"@aws-sdk/signature-v4-crt\\\" package explicitly. \\n\" +\n                        \"For more information please go to https://github.com/aws/aws-sdk-js-v3#known-issues\";\n                throw e;\n            }\n            this.sigv4aSigner = new CrtSignerV4_1(__assign(__assign({}, this.signerOptions), { signingAlgorithm: 1 }));\n        }\n        return this.sigv4aSigner;\n    };\n    return S3SignatureV4;\n}());\nexport { S3SignatureV4 };\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}