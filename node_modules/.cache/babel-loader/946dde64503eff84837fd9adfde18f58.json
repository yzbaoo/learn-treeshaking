{"ast":null,"code":"var eachLimit = function (arr, limit, iterator, callback) {\n  callback = callback || function () {};\n\n  if (!arr.length || limit <= 0) {\n    return callback();\n  }\n\n  var completed = 0;\n  var started = 0;\n  var running = 0;\n\n  (function replenish() {\n    if (completed >= arr.length) {\n      return callback();\n    }\n\n    while (running < limit && started < arr.length) {\n      started += 1;\n      running += 1;\n      iterator(arr[started - 1], function (err) {\n        if (err) {\n          callback(err);\n\n          callback = function () {};\n        } else {\n          completed += 1;\n          running -= 1;\n\n          if (completed >= arr.length) {\n            callback();\n          } else {\n            replenish();\n          }\n        }\n      });\n    }\n  })();\n};\n\nvar retry = function (times, iterator, callback) {\n  var next = function (index) {\n    iterator(function (err, data) {\n      if (err && index < times) {\n        next(index + 1);\n      } else {\n        callback(err, data);\n      }\n    });\n  };\n\n  if (times < 1) {\n    callback();\n  } else {\n    next(1);\n  }\n};\n\nvar async = {\n  eachLimit: eachLimit,\n  retry: retry\n};\nmodule.exports = async;","map":{"version":3,"names":["eachLimit","arr","limit","iterator","callback","length","completed","started","running","replenish","err","retry","times","next","index","data","async","module","exports"],"sources":["/Users/yzbaoo/Desktop/huohua/ilc-web-packages/node_modules/cos-js-sdk-v5/src/async.js"],"sourcesContent":["var eachLimit = function (arr, limit, iterator, callback) {\n    callback = callback || function () {};\n    if (!arr.length || limit <= 0) {\n        return callback();\n    }\n\n    var completed = 0;\n    var started = 0;\n    var running = 0;\n\n    (function replenish () {\n        if (completed >= arr.length) {\n            return callback();\n        }\n\n        while (running < limit && started < arr.length) {\n            started += 1;\n            running += 1;\n            iterator(arr[started - 1], function (err) {\n\n                if (err) {\n                    callback(err);\n                    callback = function () {};\n                } else {\n                    completed += 1;\n                    running -= 1;\n                    if (completed >= arr.length) {\n                        callback();\n                    } else {\n                        replenish();\n                    }\n                }\n            });\n        }\n    })();\n};\n\nvar retry = function (times, iterator, callback) {\n    var next = function (index) {\n        iterator(function (err, data) {\n            if (err && index < times) {\n                next(index + 1);\n            } else {\n                callback(err, data);\n            }\n        });\n    };\n    if (times < 1) {\n        callback();\n    } else {\n        next(1);\n    }\n};\n\nvar async = {\n    eachLimit: eachLimit,\n    retry: retry\n};\n\nmodule.exports = async;"],"mappings":"AAAA,IAAIA,SAAS,GAAG,UAAUC,GAAV,EAAeC,KAAf,EAAsBC,QAAtB,EAAgCC,QAAhC,EAA0C;EACtDA,QAAQ,GAAGA,QAAQ,IAAI,YAAY,CAAE,CAArC;;EACA,IAAI,CAACH,GAAG,CAACI,MAAL,IAAeH,KAAK,IAAI,CAA5B,EAA+B;IAC3B,OAAOE,QAAQ,EAAf;EACH;;EAED,IAAIE,SAAS,GAAG,CAAhB;EACA,IAAIC,OAAO,GAAG,CAAd;EACA,IAAIC,OAAO,GAAG,CAAd;;EAEA,CAAC,SAASC,SAAT,GAAsB;IACnB,IAAIH,SAAS,IAAIL,GAAG,CAACI,MAArB,EAA6B;MACzB,OAAOD,QAAQ,EAAf;IACH;;IAED,OAAOI,OAAO,GAAGN,KAAV,IAAmBK,OAAO,GAAGN,GAAG,CAACI,MAAxC,EAAgD;MAC5CE,OAAO,IAAI,CAAX;MACAC,OAAO,IAAI,CAAX;MACAL,QAAQ,CAACF,GAAG,CAACM,OAAO,GAAG,CAAX,CAAJ,EAAmB,UAAUG,GAAV,EAAe;QAEtC,IAAIA,GAAJ,EAAS;UACLN,QAAQ,CAACM,GAAD,CAAR;;UACAN,QAAQ,GAAG,YAAY,CAAE,CAAzB;QACH,CAHD,MAGO;UACHE,SAAS,IAAI,CAAb;UACAE,OAAO,IAAI,CAAX;;UACA,IAAIF,SAAS,IAAIL,GAAG,CAACI,MAArB,EAA6B;YACzBD,QAAQ;UACX,CAFD,MAEO;YACHK,SAAS;UACZ;QACJ;MACJ,CAdO,CAAR;IAeH;EACJ,CAxBD;AAyBH,CAnCD;;AAqCA,IAAIE,KAAK,GAAG,UAAUC,KAAV,EAAiBT,QAAjB,EAA2BC,QAA3B,EAAqC;EAC7C,IAAIS,IAAI,GAAG,UAAUC,KAAV,EAAiB;IACxBX,QAAQ,CAAC,UAAUO,GAAV,EAAeK,IAAf,EAAqB;MAC1B,IAAIL,GAAG,IAAII,KAAK,GAAGF,KAAnB,EAA0B;QACtBC,IAAI,CAACC,KAAK,GAAG,CAAT,CAAJ;MACH,CAFD,MAEO;QACHV,QAAQ,CAACM,GAAD,EAAMK,IAAN,CAAR;MACH;IACJ,CANO,CAAR;EAOH,CARD;;EASA,IAAIH,KAAK,GAAG,CAAZ,EAAe;IACXR,QAAQ;EACX,CAFD,MAEO;IACHS,IAAI,CAAC,CAAD,CAAJ;EACH;AACJ,CAfD;;AAiBA,IAAIG,KAAK,GAAG;EACRhB,SAAS,EAAEA,SADH;EAERW,KAAK,EAAEA;AAFC,CAAZ;AAKAM,MAAM,CAACC,OAAP,GAAiBF,KAAjB"},"metadata":{},"sourceType":"script"}