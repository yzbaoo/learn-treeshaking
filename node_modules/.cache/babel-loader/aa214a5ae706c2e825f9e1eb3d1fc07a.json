{"ast":null,"code":"var stringifyPrimitive = function (v) {\n  switch (typeof v) {\n    case 'string':\n      return v;\n\n    case 'boolean':\n      return v ? 'true' : 'false';\n\n    case 'number':\n      return isFinite(v) ? v : '';\n\n    default:\n      return '';\n  }\n};\n\nvar queryStringify = function (obj, sep, eq, name) {\n  sep = sep || '&';\n  eq = eq || '=';\n\n  if (obj === null) {\n    obj = undefined;\n  }\n\n  if (typeof obj === 'object') {\n    return Object.keys(obj).map(function (k) {\n      var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n\n      if (Array.isArray(obj[k])) {\n        return obj[k].map(function (v) {\n          return ks + encodeURIComponent(stringifyPrimitive(v));\n        }).join(sep);\n      } else {\n        return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n      }\n    }).filter(Boolean).join(sep);\n  }\n\n  if (!name) return '';\n  return encodeURIComponent(stringifyPrimitive(name)) + eq + encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar xhrRes = function (err, xhr, body) {\n  var headers = {};\n  xhr.getAllResponseHeaders().trim().split('\\n').forEach(function (item) {\n    if (item) {\n      var index = item.indexOf(':');\n      var key = item.substr(0, index).trim().toLowerCase();\n      var val = item.substr(index + 1).trim();\n      headers[key] = val;\n    }\n  });\n  return {\n    error: err,\n    statusCode: xhr.status,\n    statusMessage: xhr.statusText,\n    headers: headers,\n    body: body\n  };\n};\n\nvar xhrBody = function (xhr, dataType) {\n  return !dataType && dataType === 'text' ? xhr.responseText : xhr.response;\n};\n\nvar request = function (opt, callback) {\n  // method\n  var method = (opt.method || 'GET').toUpperCase(); // url、qs\n\n  var url = opt.url;\n\n  if (opt.qs) {\n    var qsStr = queryStringify(opt.qs);\n\n    if (qsStr) {\n      url += (url.indexOf('?') === -1 ? '?' : '&') + qsStr;\n    }\n  } // 创建 ajax 实例\n\n\n  var xhr = new XMLHttpRequest();\n  xhr.open(method, url, true);\n  xhr.responseType = opt.dataType || 'text'; // 处理 xhrFields 属性\n\n  if (opt.xhrFields) {\n    for (var xhrField in opt.xhrFields) {\n      xhr[xhrField] = opt.xhrFields[xhrField];\n    }\n  } // 处理 headers\n\n\n  var headers = opt.headers;\n\n  if (headers) {\n    for (var key in headers) {\n      if (headers.hasOwnProperty(key) && key.toLowerCase() !== 'content-length' && key.toLowerCase() !== 'user-agent' && key.toLowerCase() !== 'origin' && key.toLowerCase() !== 'host') {\n        xhr.setRequestHeader(key, headers[key]);\n      }\n    }\n  } // onprogress\n\n\n  if (opt.onProgress && xhr.upload) xhr.upload.onprogress = opt.onProgress;\n  if (opt.onDownloadProgress) xhr.onprogress = opt.onDownloadProgress; // timeout\n\n  if (opt.timeout) xhr.timeout = opt.timeout;\n\n  xhr.ontimeout = function (event) {\n    var error = new Error('timeout');\n    callback(xhrRes(error, xhr));\n  }; // success 2xx/3xx/4xx\n\n\n  xhr.onload = function () {\n    callback(xhrRes(null, xhr, xhrBody(xhr, opt.dataType)));\n  }; // error 5xx/0 (网络错误、跨域报错、Https connect-src 限制的报错时 statusCode 为 0)\n\n\n  xhr.onerror = function (err) {\n    var body = xhrBody(xhr, opt.dataType);\n\n    if (body) {\n      // 5xx\n      callback(xhrRes(null, xhr, body));\n    } else {\n      // 0\n      var error = xhr.statusText;\n      if (!error && xhr.status === 0) error = new Error('CORS blocked or network error');\n      callback(xhrRes(error, xhr, body));\n    }\n  }; // send\n\n\n  xhr.send(opt.body || ''); // 返回 ajax 实例，用于外部调用 xhr.abort\n\n  return xhr;\n};\n\nmodule.exports = request;","map":{"version":3,"names":["stringifyPrimitive","v","isFinite","queryStringify","obj","sep","eq","name","undefined","Object","keys","map","k","ks","encodeURIComponent","Array","isArray","join","filter","Boolean","xhrRes","err","xhr","body","headers","getAllResponseHeaders","trim","split","forEach","item","index","indexOf","key","substr","toLowerCase","val","error","statusCode","status","statusMessage","statusText","xhrBody","dataType","responseText","response","request","opt","callback","method","toUpperCase","url","qs","qsStr","XMLHttpRequest","open","responseType","xhrFields","xhrField","hasOwnProperty","setRequestHeader","onProgress","upload","onprogress","onDownloadProgress","timeout","ontimeout","event","Error","onload","onerror","send","module","exports"],"sources":["/Users/yzbaoo/Desktop/huohua/ilc-web-packages/node_modules/cos-js-sdk-v5/lib/request.js"],"sourcesContent":["var stringifyPrimitive = function(v) {\n    switch (typeof v) {\n        case 'string':\n            return v;\n        case 'boolean':\n            return v ? 'true' : 'false';\n        case 'number':\n            return isFinite(v) ? v : '';\n        default:\n            return '';\n    }\n};\n\nvar queryStringify = function(obj, sep, eq, name) {\n    sep = sep || '&';\n    eq = eq || '=';\n    if (obj === null) {\n        obj = undefined;\n    }\n    if (typeof obj === 'object') {\n        return Object.keys(obj).map(function(k) {\n            var ks = encodeURIComponent(stringifyPrimitive(k)) + eq;\n            if (Array.isArray(obj[k])) {\n                return obj[k].map(function(v) {\n                    return ks + encodeURIComponent(stringifyPrimitive(v));\n                }).join(sep);\n            } else {\n                return ks + encodeURIComponent(stringifyPrimitive(obj[k]));\n            }\n        }).filter(Boolean).join(sep);\n\n    }\n    if (!name) return '';\n    return encodeURIComponent(stringifyPrimitive(name)) + eq +\n        encodeURIComponent(stringifyPrimitive(obj));\n};\n\nvar xhrRes = function (err, xhr, body) {\n    var headers = {};\n    xhr.getAllResponseHeaders().trim().split('\\n').forEach(function (item) {\n        if (item) {\n            var index = item.indexOf(':');\n            var key = item.substr(0, index).trim().toLowerCase();\n            var val = item.substr(index + 1).trim();\n            headers[key] = val;\n        }\n    });\n    return {\n        error: err,\n        statusCode: xhr.status,\n        statusMessage: xhr.statusText,\n        headers: headers,\n        body: body,\n    };\n};\n\nvar xhrBody = function (xhr, dataType) {\n    return !dataType && dataType === 'text' ? xhr.responseText : xhr.response;\n};\n\nvar request = function (opt, callback) {\n\n    // method\n    var method = (opt.method || 'GET').toUpperCase();\n\n    // url、qs\n    var url = opt.url;\n    if (opt.qs) {\n        var qsStr = queryStringify(opt.qs);\n        if (qsStr) {\n            url += (url.indexOf('?') === -1 ? '?' : '&') + qsStr;\n        }\n    }\n\n    // 创建 ajax 实例\n    var xhr = new XMLHttpRequest();\n    xhr.open(method, url, true);\n    xhr.responseType = opt.dataType || 'text';\n\n    // 处理 xhrFields 属性\n    if (opt.xhrFields) {\n        for (var xhrField in opt.xhrFields) {\n            xhr[xhrField] = opt.xhrFields[xhrField]\n        }\n    }\n\n    // 处理 headers\n    var headers = opt.headers;\n    if (headers) {\n        for (var key in headers) {\n            if (headers.hasOwnProperty(key) &&\n                key.toLowerCase() !== 'content-length' &&\n                key.toLowerCase() !== 'user-agent' &&\n                key.toLowerCase() !== 'origin' &&\n                key.toLowerCase() !== 'host') {\n                xhr.setRequestHeader(key, headers[key]);\n            }\n        }\n    }\n\n    // onprogress\n    if (opt.onProgress && xhr.upload) xhr.upload.onprogress = opt.onProgress;\n    if (opt.onDownloadProgress) xhr.onprogress = opt.onDownloadProgress;\n\n    // timeout\n    if (opt.timeout) xhr.timeout = opt.timeout;\n    xhr.ontimeout = function(event){\n        var error = new Error('timeout');\n        callback(xhrRes(error, xhr));\n    };\n\n    // success 2xx/3xx/4xx\n    xhr.onload = function () {\n        callback(xhrRes(null, xhr, xhrBody(xhr, opt.dataType)));\n    };\n\n    // error 5xx/0 (网络错误、跨域报错、Https connect-src 限制的报错时 statusCode 为 0)\n    xhr.onerror = function (err) {\n        var body = xhrBody(xhr, opt.dataType);\n        if (body) { // 5xx\n            callback(xhrRes(null, xhr, body));\n        } else { // 0\n            var error = xhr.statusText;\n            if (!error && xhr.status === 0) error = new Error('CORS blocked or network error');\n            callback(xhrRes(error, xhr, body));\n        }\n    };\n\n    // send\n    xhr.send(opt.body || '');\n\n    // 返回 ajax 实例，用于外部调用 xhr.abort\n    return xhr;\n};\n\nmodule.exports = request;\n"],"mappings":"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"},"metadata":{},"sourceType":"script"}