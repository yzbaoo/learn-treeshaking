{"ast":null,"code":"import { __assign, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayBuffer } from \"@aws-sdk/is-array-buffer\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nexport var applyMd5BodyChecksumMiddleware = function (options) {\n  return function (next) {\n    return function (args) {\n      return __awaiter(void 0, void 0, void 0, function () {\n        var request, body, headers, digest, hash, _a, _b, _c, _d, _e;\n\n        var _f, _g;\n\n        return __generator(this, function (_h) {\n          switch (_h.label) {\n            case 0:\n              request = args.request;\n              if (!HttpRequest.isInstance(request)) return [3, 2];\n              body = request.body, headers = request.headers;\n              if (!!hasHeader(\"content-md5\", headers)) return [3, 2];\n              digest = void 0;\n\n              if (body === undefined || typeof body === \"string\" || ArrayBuffer.isView(body) || isArrayBuffer(body)) {\n                hash = new options.md5();\n                hash.update(body || \"\");\n                digest = hash.digest();\n              } else {\n                digest = options.streamHasher(options.md5, body);\n              }\n\n              _a = [__assign({}, request)];\n              _f = {};\n              _b = [__assign({}, headers)];\n              _g = {};\n              _c = \"content-md5\";\n              _e = (_d = options).base64Encoder;\n              return [4, digest];\n\n            case 1:\n              request = __assign.apply(void 0, _a.concat([(_f.headers = __assign.apply(void 0, _b.concat([(_g[_c] = _e.apply(_d, [_h.sent()]), _g)])), _f)]));\n              _h.label = 2;\n\n            case 2:\n              return [2, next(__assign(__assign({}, args), {\n                request: request\n              }))];\n          }\n        });\n      });\n    };\n  };\n};\nexport var applyMd5BodyChecksumMiddlewareOptions = {\n  name: \"applyMd5BodyChecksumMiddleware\",\n  step: \"build\",\n  tags: [\"SET_CONTENT_MD5\", \"BODY_CHECKSUM\"],\n  override: true\n};\nexport var getApplyMd5BodyChecksumPlugin = function (config) {\n  return {\n    applyToStack: function (clientStack) {\n      clientStack.add(applyMd5BodyChecksumMiddleware(config), applyMd5BodyChecksumMiddlewareOptions);\n    }\n  };\n};\n\nvar hasHeader = function (soughtHeader, headers) {\n  var e_1, _a;\n\n  soughtHeader = soughtHeader.toLowerCase();\n\n  try {\n    for (var _b = __values(Object.keys(headers)), _c = _b.next(); !_c.done; _c = _b.next()) {\n      var headerName = _c.value;\n\n      if (soughtHeader === headerName.toLowerCase()) {\n        return true;\n      }\n    }\n  } catch (e_1_1) {\n    e_1 = {\n      error: e_1_1\n    };\n  } finally {\n    try {\n      if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n    } finally {\n      if (e_1) throw e_1.error;\n    }\n  }\n\n  return false;\n};","map":{"version":3,"names":["__assign","__awaiter","__generator","__values","isArrayBuffer","HttpRequest","applyMd5BodyChecksumMiddleware","options","next","args","request","body","headers","digest","hash","_a","_b","_c","_d","_e","_f","_g","_h","label","isInstance","hasHeader","undefined","ArrayBuffer","isView","md5","update","streamHasher","base64Encoder","apply","concat","sent","applyMd5BodyChecksumMiddlewareOptions","name","step","tags","override","getApplyMd5BodyChecksumPlugin","config","applyToStack","clientStack","add","soughtHeader","e_1","toLowerCase","Object","keys","done","headerName","value","e_1_1","error","return","call"],"sources":["/Users/yzbaoo/Desktop/huohua/ilc-web-packages/node_modules/@aws-sdk/middleware-apply-body-checksum/dist-es/applyMd5BodyChecksumMiddleware.js"],"sourcesContent":["import { __assign, __awaiter, __generator, __values } from \"tslib\";\nimport { isArrayBuffer } from \"@aws-sdk/is-array-buffer\";\nimport { HttpRequest } from \"@aws-sdk/protocol-http\";\nexport var applyMd5BodyChecksumMiddleware = function (options) {\n    return function (next) {\n        return function (args) { return __awaiter(void 0, void 0, void 0, function () {\n            var request, body, headers, digest, hash, _a, _b, _c, _d, _e;\n            var _f, _g;\n            return __generator(this, function (_h) {\n                switch (_h.label) {\n                    case 0:\n                        request = args.request;\n                        if (!HttpRequest.isInstance(request)) return [3, 2];\n                        body = request.body, headers = request.headers;\n                        if (!!hasHeader(\"content-md5\", headers)) return [3, 2];\n                        digest = void 0;\n                        if (body === undefined || typeof body === \"string\" || ArrayBuffer.isView(body) || isArrayBuffer(body)) {\n                            hash = new options.md5();\n                            hash.update(body || \"\");\n                            digest = hash.digest();\n                        }\n                        else {\n                            digest = options.streamHasher(options.md5, body);\n                        }\n                        _a = [__assign({}, request)];\n                        _f = {};\n                        _b = [__assign({}, headers)];\n                        _g = {};\n                        _c = \"content-md5\";\n                        _e = (_d = options).base64Encoder;\n                        return [4, digest];\n                    case 1:\n                        request = __assign.apply(void 0, _a.concat([(_f.headers = __assign.apply(void 0, _b.concat([(_g[_c] = _e.apply(_d, [_h.sent()]), _g)])), _f)]));\n                        _h.label = 2;\n                    case 2: return [2, next(__assign(__assign({}, args), { request: request }))];\n                }\n            });\n        }); };\n    };\n};\nexport var applyMd5BodyChecksumMiddlewareOptions = {\n    name: \"applyMd5BodyChecksumMiddleware\",\n    step: \"build\",\n    tags: [\"SET_CONTENT_MD5\", \"BODY_CHECKSUM\"],\n    override: true,\n};\nexport var getApplyMd5BodyChecksumPlugin = function (config) { return ({\n    applyToStack: function (clientStack) {\n        clientStack.add(applyMd5BodyChecksumMiddleware(config), applyMd5BodyChecksumMiddlewareOptions);\n    },\n}); };\nvar hasHeader = function (soughtHeader, headers) {\n    var e_1, _a;\n    soughtHeader = soughtHeader.toLowerCase();\n    try {\n        for (var _b = __values(Object.keys(headers)), _c = _b.next(); !_c.done; _c = _b.next()) {\n            var headerName = _c.value;\n            if (soughtHeader === headerName.toLowerCase()) {\n                return true;\n            }\n        }\n    }\n    catch (e_1_1) { e_1 = { error: e_1_1 }; }\n    finally {\n        try {\n            if (_c && !_c.done && (_a = _b.return)) _a.call(_b);\n        }\n        finally { if (e_1) throw e_1.error; }\n    }\n    return false;\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}